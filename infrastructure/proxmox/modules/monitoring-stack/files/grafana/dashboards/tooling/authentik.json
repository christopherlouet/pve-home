{"id":null,"uid":"authentik","title":"Authentik - SSO Monitoring","description":"Authentik SSO monitoring: logins, OAuth flows, users, outposts","tags":["tooling","sso","authentik","oauth"],"timezone":"browser","editable":false,"graphTooltip":1,"refresh":"30s","time":{"from":"now-1h","to":"now"},"templating":{"list":[{"name":"instance","type":"query","datasource":{"type":"prometheus","uid":"prometheus"},"query":"label_values(authentik_system_health, instance)","current":{"text":"All","value":"$__all"},"includeAll":true,"multi":true}]},"panels":[{"title":"System Health","type":"stat","gridPos":{"h":4,"w":4,"x":0,"y":0},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"mappings":[{"type":"value","options":{"1":{"text":"Healthy","color":"green"},"0":{"text":"Unhealthy","color":"red"}}}],"thresholds":{"steps":[{"color":"red","value":null},{"color":"green","value":1}]}},"overrides":[]},"options":{"colorMode":"background","graphMode":"none","textMode":"auto"},"targets":[{"expr":"authentik_system_health{instance=~\"$instance\"}","legendFormat":"","refId":"A"}]},{"title":"Logins (24h)","type":"stat","gridPos":{"h":4,"w":4,"x":4,"y":0},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"thresholds":{"steps":[{"color":"blue","value":null}]}},"overrides":[]},"options":{"colorMode":"value","graphMode":"area","textMode":"auto"},"targets":[{"expr":"increase(authentik_login_total{instance=~\"$instance\"}[24h])","legendFormat":"","refId":"A"}]},{"title":"Failed Logins (24h)","type":"stat","gridPos":{"h":4,"w":4,"x":8,"y":0},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"thresholds":{"steps":[{"color":"green","value":null},{"color":"yellow","value":5},{"color":"red","value":20}]}},"overrides":[]},"options":{"colorMode":"background","graphMode":"area","textMode":"auto"},"targets":[{"expr":"increase(authentik_login_failed_total{instance=~\"$instance\"}[24h])","legendFormat":"","refId":"A"}]},{"title":"Active Users","type":"stat","gridPos":{"h":4,"w":4,"x":12,"y":0},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"thresholds":{"steps":[{"color":"purple","value":null}]}},"overrides":[]},"options":{"colorMode":"value","graphMode":"none","textMode":"auto"},"targets":[{"expr":"authentik_user_count{is_active=\"true\",instance=~\"$instance\"}","legendFormat":"","refId":"A"}]},{"title":"Total Users","type":"stat","gridPos":{"h":4,"w":4,"x":16,"y":0},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"thresholds":{"steps":[{"color":"blue","value":null}]}},"overrides":[]},"options":{"colorMode":"value","graphMode":"none","textMode":"auto"},"targets":[{"expr":"sum(authentik_user_count{instance=~\"$instance\"})","legendFormat":"","refId":"A"}]},{"title":"Active Sessions","type":"stat","gridPos":{"h":4,"w":4,"x":20,"y":0},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"thresholds":{"steps":[{"color":"green","value":null}]}},"overrides":[]},"options":{"colorMode":"value","graphMode":"area","textMode":"auto"},"targets":[{"expr":"authentik_session_count{instance=~\"$instance\"}","legendFormat":"","refId":"A"}]},{"title":"Authentication","type":"row","gridPos":{"h":1,"w":24,"x":0,"y":4},"collapsed":false,"panels":[]},{"title":"Login Rate","type":"timeseries","gridPos":{"h":8,"w":12,"x":0,"y":5},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"ops","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","max"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"rate(authentik_login_total{instance=~\"$instance\"}[5m])","legendFormat":"Success","refId":"A"},{"expr":"rate(authentik_login_failed_total{instance=~\"$instance\"}[5m])","legendFormat":"Failed","refId":"B"}]},{"title":"Login Success Rate","type":"timeseries","gridPos":{"h":8,"w":12,"x":12,"y":5},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"percentunit","min":0,"max":1,"custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","min"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"sum(rate(authentik_login_total{instance=~\"$instance\"}[5m])) / (sum(rate(authentik_login_total{instance=~\"$instance\"}[5m])) + sum(rate(authentik_login_failed_total{instance=~\"$instance\"}[5m])))","legendFormat":"Success Rate","refId":"A"}]},{"title":"Logins by Application","type":"timeseries","gridPos":{"h":8,"w":12,"x":0,"y":13},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"ops","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","max"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"sum(rate(authentik_login_total{instance=~\"$instance\"}[5m])) by (application)","legendFormat":"{{ application }}","refId":"A"}]},{"title":"Authentication Flow Duration","type":"timeseries","gridPos":{"h":8,"w":12,"x":12,"y":13},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"s","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","p95"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"histogram_quantile(0.95, sum(rate(authentik_flow_execution_duration_seconds_bucket{instance=~\"$instance\"}[5m])) by (le))","legendFormat":"p95","refId":"A"},{"expr":"histogram_quantile(0.50, sum(rate(authentik_flow_execution_duration_seconds_bucket{instance=~\"$instance\"}[5m])) by (le))","legendFormat":"p50","refId":"B"}]},{"title":"OAuth2 / OIDC","type":"row","gridPos":{"h":1,"w":24,"x":0,"y":21},"collapsed":false,"panels":[]},{"title":"Token Requests","type":"timeseries","gridPos":{"h":8,"w":12,"x":0,"y":22},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"ops","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","max"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"rate(authentik_oauth_token_requests_total{instance=~\"$instance\"}[5m])","legendFormat":"{{ provider }} - {{ grant_type }}","refId":"A"}]},{"title":"Active Tokens by Provider","type":"timeseries","gridPos":{"h":8,"w":12,"x":12,"y":22},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"short","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","max"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"authentik_oauth_active_tokens{instance=~\"$instance\"}","legendFormat":"{{ provider }}","refId":"A"}]},{"title":"Outposts & Proxies","type":"row","gridPos":{"h":1,"w":24,"x":0,"y":30},"collapsed":false,"panels":[]},{"title":"Outpost Health","type":"table","gridPos":{"h":6,"w":12,"x":0,"y":31},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"mappings":[{"type":"value","options":{"1":{"text":"Up","color":"green"},"0":{"text":"Down","color":"red"}}}],"custom":{"align":"center"}},"overrides":[]},"options":{"showHeader":true,"cellHeight":"sm"},"targets":[{"expr":"authentik_outpost_health{instance=~\"$instance\"}","legendFormat":"","format":"table","refId":"A"}],"transformations":[{"id":"organize","options":{"excludeByName":{"Time":true,"__name__":true,"job":true},"renameByName":{"outpost":"Outpost","instance":"Instance","value":"Status"}}}]},{"title":"Forward Auth Requests","type":"timeseries","gridPos":{"h":8,"w":12,"x":12,"y":31},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"ops","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","max"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"rate(authentik_outpost_proxy_requests_total{instance=~\"$instance\"}[5m])","legendFormat":"{{ outpost }}","refId":"A"}]},{"title":"System Resources","type":"row","gridPos":{"h":1,"w":24,"x":0,"y":39},"collapsed":true,"panels":[{"title":"Worker Tasks","type":"timeseries","gridPos":{"h":8,"w":12,"x":0,"y":40},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"ops","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","max"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"rate(authentik_worker_tasks_total{instance=~\"$instance\"}[5m])","legendFormat":"{{ task }}","refId":"A"}]},{"title":"Task Queue","type":"timeseries","gridPos":{"h":8,"w":12,"x":12,"y":40},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"short","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","max"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"authentik_worker_queue_length{instance=~\"$instance\"}","legendFormat":"Queue Length","refId":"A"}]},{"title":"HTTP Request Duration","type":"timeseries","gridPos":{"h":8,"w":12,"x":0,"y":48},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"s","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","p95"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"histogram_quantile(0.95, sum(rate(authentik_http_request_duration_seconds_bucket{instance=~\"$instance\"}[5m])) by (le, method))","legendFormat":"p95 {{ method }}","refId":"A"}]},{"title":"Database Queries","type":"timeseries","gridPos":{"h":8,"w":12,"x":12,"y":48},"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"unit":"ops","custom":{"fillOpacity":20,"lineWidth":2,"spanNulls":false}},"overrides":[]},"options":{"legend":{"displayMode":"table","calcs":["mean","max"]},"tooltip":{"mode":"multi"}},"targets":[{"expr":"rate(authentik_database_queries_total{instance=~\"$instance\"}[5m])","legendFormat":"Queries/s","refId":"A"}]}]}],"schemaVersion":39,"version":1}
